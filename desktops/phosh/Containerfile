ARG from
FROM $from

ARG target_tag

RUN dnf -y install \
    @phosh-desktop \
    phrog \
    gnome-software-rpm-ostree \
    nautilus \
    ptyxis \
    default-flatpaks \
    --exclude gnome-calculator \
    --exclude gnome-calendar \
    --exclude gnome-clocks \
    --exclude gnome-console \
    --exclude gnome-contacts \
    --exclude gnome-maps \
    --exclude gnome-photos \
    --exclude gnome-tour \
    --exclude malcontent-control \
    --exclude pavucontrol \
    --exclude showtime \
    --exclude epiphany \
    --exclude chatty \
    --exclude calls \
    --exclude totem \
    --exclude PackageKit

RUN systemctl enable --force phrog.service

# os-release file
RUN sed -i "s/^PRETTY_NAME=.*/PRETTY_NAME=\"Fedora Linux $target_tag (phosh)\"/" /usr/lib/os-release

# cleanup
RUN dnf clean all && rm -rf /var/log/*

RUN bootc container lint --no-truncate
