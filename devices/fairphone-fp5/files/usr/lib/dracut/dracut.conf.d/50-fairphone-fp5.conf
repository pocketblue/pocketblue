# Fairphone 5 (QCM6490/SC7280) dracut configuration

# Firmware for initramfs - include all device-specific firmware
install_optional_items+=" /usr/lib/firmware/qcom/qcm6490/fairphone5/* "
install_optional_items+=" /usr/lib/firmware/qcom/a660_sqe.fw /usr/lib/firmware/qcom/a660_gmu.bin "
install_optional_items+=" /usr/lib/firmware/qca/msbtfw11.mbn /usr/lib/firmware/qca/msbtfw11.tlv /usr/lib/firmware/qca/msnv11.bin "

# NSS files for group/user resolution in initramfs
install_items+=" /etc/passwd /etc/group /etc/shadow /etc/nsswitch.conf "
install_items+=" /usr/lib64/libnss_files.so.2 /lib64/libnss_files.so.2 "
install_optional_items+=" /usr/lib64/libnss_compat.so.2 /lib64/libnss_compat.so.2 "

# Include modprobe configuration for initramfs
install_items+=" /usr/lib/modprobe.d/fairphone-fp5.conf "

# Touchscreen and Type-C mux drivers
add_drivers+=" goodix_berlin_core goodix_berlin_spi "
add_drivers+=" fsa4480 ptn36502 "

# UFS storage drivers (required to access root filesystem)
add_drivers+=" ufs_qcom ufshcd_pltfrm ufshcd_core phy_qcom_qmp_ufs "

# Panel driver (may be built-in or module depending on config)
install_optional_items+=" /usr/lib/modules/*/kernel/drivers/gpu/drm/panel/panel-raydium-rm692e5.ko* "

# SPI/I2C bus drivers (often built-in, but include if modules)
install_optional_items+=" /usr/lib/modules/*/kernel/drivers/spi/spi-geni-qcom.ko* "
install_optional_items+=" /usr/lib/modules/*/kernel/drivers/i2c/busses/i2c-qcom-geni.ko* "

# Remoteproc/DSP (may be modules)
add_drivers+=" qcom_q6v5_pas qcom_pil_info qcom_sysmon "
add_drivers+=" qcom_glink qcom_glink_rpm qcom_smd "
add_drivers+=" qrtr qrtr_smd "

# Filesystems
filesystems+=" ext4 f2fs btrfs xfs "

# Dracut modules
add_dracutmodules+=" systemd systemd-initrd base rootfs-block dm ostree "

compress="zstd"
dracut_rescue_image="no"
hostonly="no"
hostonly_cmdline="no"
