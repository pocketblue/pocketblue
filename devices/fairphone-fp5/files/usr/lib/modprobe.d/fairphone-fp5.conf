# Fairphone 5 (QCM6490) module configuration

# ALSA: snd-seq not available, prevent boot error
install snd-pcm /sbin/modprobe --ignore-install snd-pcm

# USB-C Alt Mode - Type-C mux drivers load before pmic-glink
softdep qcom_pmic_glink pre: fsa4480 ptn36502 phy-qcom-qmp-combo

# LPASS audio dependencies
softdep lpass_audio_cc_sc7280 pre: qcom_q6v5_pas qcom_common clk_qcom gcc_sc7280
softdep snd_soc_qcom_common pre: qcom_glink_smem qcom_q6v5_pas
softdep q6apm pre: qcom_q6v5_pas qcom_apr

# DisplayPort, FastRPC, USB dependencies
softdep msm_dp pre: dispcc_sc7280 phy-qcom-qmp-combo
softdep qcom_fastrpc pre: qcom_q6v5_pas
softdep dwc3_qcom pre: phy-qcom-qmp-combo phy-qcom-snps-femto-v2

# Bluetooth - ensure QCA firmware dependencies
softdep hci_uart pre: btqca btbcm
softdep btqca pre: bluetooth

# Camera - CAMSS and sensor drivers
# CAMSS needs CCI bus and camera clock controller
softdep qcom-camss pre: i2c-qcom-cci
# Sensor drivers need V4L2 CCI helpers and CAMSS must be loaded first
softdep s5kjn1 pre: v4l2-cci qcom-camss
softdep imx858 pre: v4l2-cci qcom-camss
softdep imx471 pre: v4l2-cci qcom-camss
softdep dw9719 pre: v4l2-cci qcom-camss
