# Fairphone 5 Sensor Configuration
# This file configures sensor orientation and permissions

# Accelerometer mount matrix - defines physical orientation of sensor chip
# Matrix format: x,y,z coordinates for new X; new Y; new Z axis
# FP5 sensor orientation (may need adjustment based on actual hardware)
ACTION=="add", SUBSYSTEM=="iio", KERNEL=="iio:device*", ATTR{name}=="*accel*", ENV{ACCEL_MOUNT_MATRIX}="0, 1, 0; -1, 0, 0; 0, 0, 1"

# Alternative mount matrix if sensors are accessed via SSC virtual device
ACTION=="add", SUBSYSTEM=="iio", KERNEL=="iio:device*", ATTR{name}=="*ssc*accel*", ENV{ACCEL_MOUNT_MATRIX}="0, 1, 0; -1, 0, 0; 0, 0, 1"

# Gyroscope mount matrix (should match accelerometer)
ACTION=="add", SUBSYSTEM=="iio", KERNEL=="iio:device*", ATTR{name}=="*gyro*", ENV{GYRO_MOUNT_MATRIX}="0, 1, 0; -1, 0, 0; 0, 0, 1"

# Magnetometer mount matrix (compass)
ACTION=="add", SUBSYSTEM=="iio", KERNEL=="iio:device*", ATTR{name}=="*magn*", ENV{MAGN_MOUNT_MATRIX}="0, 1, 0; -1, 0, 0; 0, 0, 1"

# Set proper permissions for IIO devices
ACTION=="add", SUBSYSTEM=="iio", KERNEL=="iio:device*", MODE="0660", GROUP="input"
ACTION=="add", SUBSYSTEM=="iio", KERNEL=="trigger*", MODE="0660", GROUP="input"

# Tag IIO devices for systemd
ACTION=="add", SUBSYSTEM=="iio", TAG+="systemd"

# Ensure iio-sensor-proxy can access the devices
ACTION=="add", SUBSYSTEM=="iio", KERNEL=="iio:device*", TAG+="uaccess", TAG+="seat"